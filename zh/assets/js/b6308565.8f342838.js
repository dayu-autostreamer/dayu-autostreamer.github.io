"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8328],{222:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/cloud-agent-ab2c8672aff704ecced4d31a17a3057f.png"},2254:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/EdgeMeshNormalRun-f302a5160c96e980c2952a371a4ee23c.jpg"},3229:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/api-f6783249e7bf0863bbbecc556bdd66ca.png"},3562:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/edge-agent-3f07a33653e8d7922c962bdd2acce216.png"},4409:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/iptables-06989a7c0522557bf3dbef641fa50e4d.png"},4642:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>g,frontMatter:()=>a,metadata:()=>l,toc:()=>i});const l=JSON.parse('{"id":"getting-started/install-lower-layer-system/install-edgemesh","title":"\u5b89\u88c5EdgeMesh","description":"EdgeMesh \u73af\u5883\u51c6\u5907\uff08\u4e91\u7aef\uff09","source":"@site/i18n/zh/docusaurus-plugin-content-docs/current/03-getting-started/02-install-lower-layer-system/04-install-edgemesh.md","sourceDirName":"03-getting-started/02-install-lower-layer-system","slug":"/getting-started/install-lower-layer-system/install-edgemesh","permalink":"/zh/docs/getting-started/install-lower-layer-system/install-edgemesh","draft":false,"unlisted":false,"editUrl":null,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_label":"\u5b89\u88c5EdgeMesh","slug":"/getting-started/install-lower-layer-system/install-edgemesh","custom_edit_url":null},"sidebar":"tutorialSidebar","previous":{"title":"\u5b89\u88c5KubeEdge","permalink":"/zh/docs/getting-started/install-lower-layer-system/install-kubeedge"},"next":{"title":"\u5b89\u88c5Sedna","permalink":"/zh/docs/getting-started/install-lower-layer-system/install-sedna"}}');var d=n(4848),t=n(8453);const a={sidebar_label:"\u5b89\u88c5EdgeMesh",slug:"/getting-started/install-lower-layer-system/install-edgemesh",custom_edit_url:null},r="\u5b89\u88c5EdgeMesh",c={},i=[{value:"EdgeMesh \u73af\u5883\u51c6\u5907\uff08\u4e91\u7aef\uff09",id:"edgemesh-\u73af\u5883\u51c6\u5907\u4e91\u7aef",level:2},{value:"\u542f\u52a8 EdgeMesh\uff08\u4e91\u8fb9\u5171\u7528\uff09",id:"\u542f\u52a8-edgemesh\u4e91\u8fb9\u5171\u7528",level:2},{value:"\u90e8\u7f72edgemesh-agent\uff08\u4e91\u7aef\uff09",id:"\u90e8\u7f72edgemesh-agent\u4e91\u7aef",level:3},{value:"\u914d\u7f6eedge\u7aef\u7f51\u7edc\uff08\u8fb9\u7aef\uff09",id:"\u914d\u7f6eedge\u7aef\u7f51\u7edc\u8fb9\u7aef",level:3},{value:"\u6b63\u5e38\u8fd0\u884c\u72b6\u6001",id:"\u6b63\u5e38\u8fd0\u884c\u72b6\u6001",level:3},{value:"\u5378\u8f7dEdgemesh",id:"\u5378\u8f7dedgemesh",level:3}];function h(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.header,{children:(0,d.jsx)(s.h1,{id:"\u5b89\u88c5edgemesh",children:"\u5b89\u88c5EdgeMesh"})}),"\n",(0,d.jsx)(s.h2,{id:"edgemesh-\u73af\u5883\u51c6\u5907\u4e91\u7aef",children:"EdgeMesh \u73af\u5883\u51c6\u5907\uff08\u4e91\u7aef\uff09"}),"\n",(0,d.jsxs)(s.p,{children:["\u53ef\u80fd\u51fa\u73b0 ",(0,d.jsx)(s.a,{href:"/docs/getting-started/install-lower-layer-system/faqs#%E9%97%AE%E9%A2%98%E5%85%AD%E7%BC%BA%E5%B0%91-tlsstreamcertfile",children:"\u95ee\u9898\u516d\uff1a\u7f3a\u5c11 TLSStreamCertFile"})]}),"\n",(0,d.jsx)(s.p,{children:"\u6b65\u9aa4 1: \u53bb\u9664 K8s master \u8282\u70b9\u7684\u6c61\u70b9"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"kubectl taint nodes --all node-role.kubernetes.io/master-\n"})}),"\n",(0,d.jsx)(s.p,{children:"\u6b65\u9aa4 2: \u7ed9 Kubernetes API \u670d\u52a1\u6dfb\u52a0\u8fc7\u6ee4\u6807\u7b7e"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:'kubectl label services kubernetes service.edgemesh.kubeedge.io/service-proxy-name=""\n'})}),"\n",(0,d.jsx)(s.p,{children:"\u6b65\u9aa4 3: \u542f\u7528 KubeEdge \u7684\u8fb9\u7f18 Kube-API \u7aef\u70b9\u670d\u52a1"}),"\n",(0,d.jsx)(s.p,{children:"\u5728\u4e91\u7aef\uff0c\u5f00\u542f dynamicController \u6a21\u5757\uff1a"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"vim /etc/kubeedge/config/cloudcore.yaml\n# \u4fee\u6539 cloudcore.yaml \u5185\u5bb9\nmodules:\n  ..\n  cloudStream:\n    enable: true\n    streamPort: 10003\n  ..\n  dynamicController:\n    enable: true\n    \n# \u91cd\u542fcloucore\nsystemctl restart cloudcore.service\n"})}),"\n",(0,d.jsx)(s.p,{children:"\u5728\u8fb9\u7aef\uff0c\u6253\u5f00 metaServer \u6a21\u5757\u548c edgeStream (\u6ce8\u610f\uff0ckeadm reset\u540e\u9700\u8981\u91cd\u65b0\u4fee\u6539)"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"vim /etc/kubeedge/config/edgecore.yaml\n# \u4fee\u6539 edgecore.yaml \u5185\u5bb9\nedgeStream:  \n\tenable: true  \n\thandshakeTimeout: 30  \n\treadDeadline: 15  \n\tserver: 192.168.0.139:10004  \n\ttlsTunnelCAFile: /etc/kubeedge/ca/rootCA.crt  \n\ttlsTunnelCertFile: /etc/kubeedge/certs/server.crt  \n\ttlsTunnelPrivateKeyFile: /etc/kubeedge/certs/server.key  \n\twriteDeadline: 15\n...\nmetaManager:\n    metaServer:\n      enable: true\n...\n\n# \u91cd\u542fedgecore\nsystemctl restart edgecore.service\n# \u68c0\u67e5\u72b6\u51b5\njournalctl -u edgecore.service -f\n# \u786e\u5b9a\u6b63\u5e38\u8fd0\u884c\n"})}),"\n",(0,d.jsx)(s.p,{children:"\u6b65\u9aa4 4: \u5728\u8fb9\u7f18\u8282\u70b9\uff0c\u6d4b\u8bd5\u8fb9\u7f18 Kube-API \u7aef\u70b9\u529f\u80fd\u662f\u5426\u6b63\u5e38"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"# \u8fb9\u7f18\u8282\u70b9\u4e0a\ncurl 127.0.0.1:10550/api/v1/services\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.img,{alt:"api",src:n(3229).A+"",width:"2230",height:"655"})}),"\n",(0,d.jsx)(s.p,{children:"\u5982\u679c\u8fd4\u56de\u503c\u662f\u7a7a\u5217\u8868\uff0c\u6216\u8005\u54cd\u5e94\u65f6\u957f\u5f88\u4e45\uff08\u63a5\u8fd1 10 s\uff09\u624d\u62ff\u5230\u8fd4\u56de\u503c\uff0c\u8bf4\u660e\u914d\u7f6e\u53ef\u80fd\u6709\u8bef\uff0c\u8bf7\u4ed4\u7ec6\u68c0\u67e5\u3002"}),"\n",(0,d.jsx)(s.h2,{id:"\u542f\u52a8-edgemesh\u4e91\u8fb9\u5171\u7528",children:"\u542f\u52a8 EdgeMesh\uff08\u4e91\u8fb9\u5171\u7528\uff09"}),"\n",(0,d.jsxs)(s.blockquote,{children:["\n",(0,d.jsx)(s.p,{children:"\u6b64\u5904\u95ee\u9898\u91cd\u707e\u533a\uff0c\u9047\u5230\u95ee\u9898\u53ef\u53c2\u7167EdgeMesh\u5b98\u65b9\u624b\u518c\u6392\u67e5\uff1a"}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://edgemesh.netlify.app/zh/guide/#%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85",children:"\u5feb\u901f\u4e0a\u624b | EdgeMesh"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://zhuanlan.zhihu.com/p/585749690",children:"\u5168\u7f51\u6700\u5168EdgeMesh Q&A\u624b\u518c - \u77e5\u4e4e (zhihu.com)"})}),"\n"]}),"\n",(0,d.jsx)(s.h3,{id:"\u90e8\u7f72edgemesh-agent\u4e91\u7aef",children:"\u90e8\u7f72edgemesh-agent\uff08\u4e91\u7aef\uff09"}),"\n",(0,d.jsx)(s.p,{children:"\u4e0b\u8f7d edgemesh\u4ee3\u7801"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"# clone edgemesh\u4ee3\u7801\ngit clone https://github.com/dayu-autostreamer/dayu-edgemesh.git\n# \u8fdb\u5165\u4ee3\u7801\u6587\u4ef6\u5939\ncd dayu-edgemesh\n"})}),"\n",(0,d.jsx)(s.p,{children:"\u6dfb\u52a0relay node"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"vim build/agent/resources/04-configmap.yaml\n\n# \u6dfb\u52a0\u4e91\u670d\u52a1\u5668\u4e3arelay node, \u4ee5\u4fbf\u4e91\u8fb9\u901a\u4fe1\uff0c\u5982\uff1a\n....\nedgeTunnel:\n        enable: true\n        relayNodes:\n        - nodeName: <hostname>\n          advertiseAddress:\n          - <ip>\n....\n\n# <hostname> <ip> \u5206\u522b\u9700\u8981\u586b\u5165\u4e91\u670d\u52a1\u5668\u7684hostname\u4e0eip\n"})}),"\n",(0,d.jsx)(s.p,{children:"\u90e8\u7f72edgemesh"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"# crd \u6587\u4ef6\u90e8\u7f72\nkubectl apply -f build/crds/istio/\n# \u5728\u96c6\u7fa4\u4e2d\u90e8\u7f72 edgemesh-agent\nkubectl apply -f build/agent/resources/\n"})}),"\n",(0,d.jsxs)(s.p,{children:["\u63d0\u793a: \u5982\u679c\u4f7f\u7528",(0,d.jsx)(s.a,{href:"/docs/developer-guide/how-to-build/docker-registry/",children:"\u5185\u7f51\u955c\u50cf\u4ed3\u5e93"}),"\uff0c\u8bf7\u8fdb\u5165yaml\u6587\u4ef6\u4e2d\u4fee\u6539image\u6e90\uff0c\u5982:"]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{children:"dayuhub/edgemesh-gateway:v1.0 -> repo:5000/dayuhub/edgemesh-gateway:v1.0\n"})}),"\n",(0,d.jsx)(s.h3,{id:"\u914d\u7f6eedge\u7aef\u7f51\u7edc\u8fb9\u7aef",children:"\u914d\u7f6eedge\u7aef\u7f51\u7edc\uff08\u8fb9\u7aef\uff09"}),"\n",(0,d.jsx)(s.p,{children:"\u914d\u7f6e edge"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"vim /etc/kubeedge/config/edgecore.yaml\n# \u4fee\u6539 edgecore.yaml \u5185\u5bb9\nedged:\n    clusterDNS: 169.254.96.16\n    clusterDomain: cluster.local\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.img,{alt:"edgecore",src:n(7766).A+"",width:"687",height:"403"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.img,{alt:"edgecore",src:n(8973).A+"",width:"404",height:"187"})}),"\n",(0,d.jsx)(s.p,{children:"\u91cd\u542fedgecore\uff1a"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"systemctl restart edgecore\n"})}),"\n",(0,d.jsx)(s.h3,{id:"\u6b63\u5e38\u8fd0\u884c\u72b6\u6001",children:"\u6b63\u5e38\u8fd0\u884c\u72b6\u6001"}),"\n",(0,d.jsx)(s.p,{children:"\u67e5\u770biptables\u72b6\u6001\uff1a"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"iptables -t nat -nvL\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.img,{alt:"iptables",src:n(4409).A+"",width:"2148",height:"478"})}),"\n",(0,d.jsx)(s.p,{children:"\u67e5\u770bedgemesh pods\u72b6\u6001\uff1a"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"kubectl get pods -n kubeedge\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.img,{alt:"normal-run",src:n(2254).A+"",width:"949",height:"351"})}),"\n",(0,d.jsx)(s.p,{children:"\u4e91\u7aeflogs\uff1a"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"kubectl logs -n kubeedge [pod-name]\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.img,{alt:"cloud-agent",src:n(222).A+"",width:"2031",height:"1014"})}),"\n",(0,d.jsx)(s.p,{children:"\u8fb9\u7aeflogs\uff1a"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"# \u67e5\u770b\u8fb9\u7aefedgemesh\nkubectl logs -n kubeedge [pod-name]\n"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.img,{alt:"edge-agent.png",src:n(3562).A+"",width:"2234",height:"1212"})}),"\n",(0,d.jsx)(s.h3,{id:"\u5378\u8f7dedgemesh",children:"\u5378\u8f7dEdgemesh"}),"\n",(0,d.jsx)(s.p,{children:"\u5982\u9700\u91cd\u88c5Edgemesh\uff0c\u8bf7\u5148\u5378\u8f7d"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-bash",children:"cd dayu-edgemesh\nkubectl delete -f build/crds/istio/\nkubectl delete -f build/agent/resources/\n"})})]})}function g(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(h,{...e})}):h(e)}},7766:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/edgecore1-3e8073fb438155d512871c86cc04524a.png"},8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>r});var l=n(6540);const d={},t=l.createContext(d);function a(e){const s=l.useContext(t);return l.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:a(e.components),l.createElement(t.Provider,{value:s},e.children)}},8973:(e,s,n)=>{n.d(s,{A:()=>l});const l=n.p+"assets/images/edgecore2-0dee8843ad287e185502c1cd99d41365.png"}}]);