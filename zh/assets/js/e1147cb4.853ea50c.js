"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8178],{2226:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>u,frontMatter:()=>d,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"getting-started/install-lower-layer-system/pre-requisites","title":"\u524d\u7f6e\u8981\u6c42","description":"\u8bf7\u5728\u5b89\u88c5\u524d\u5b8c\u6210\u524d\u7f6e\u8981\u6c42\u7684\u51c6\u5907\u5de5\u4f5c\u3002","source":"@site/i18n/zh/docusaurus-plugin-content-docs/current/03-getting-started/02-install-lower-layer-system/01-pre-requisites.md","sourceDirName":"03-getting-started/02-install-lower-layer-system","slug":"/getting-started/install-lower-layer-system/pre-requisites","permalink":"/zh/docs/getting-started/install-lower-layer-system/pre-requisites","draft":false,"unlisted":false,"editUrl":null,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"\u524d\u7f6e\u8981\u6c42","slug":"/getting-started/install-lower-layer-system/pre-requisites","custom_edit_url":null},"sidebar":"tutorialSidebar","previous":{"title":"\u5b89\u88c5\u5927\u79b9\u4e0b\u5c42\u7cfb\u7edf","permalink":"/zh/docs/getting-started/install-lower-layer-system"},"next":{"title":"\u5b89\u88c5Kubernetes","permalink":"/zh/docs/getting-started/install-lower-layer-system/install-kubernetes"}}');var t=s(4848),l=s(8453);const d={sidebar_label:"\u524d\u7f6e\u8981\u6c42",slug:"/getting-started/install-lower-layer-system/pre-requisites",custom_edit_url:null},a="\u524d\u7f6e\u8981\u6c42",i={},o=[{value:"\u5173\u95ed\u9632\u706b\u5899\uff08\u4e91\u8fb9\u5171\u7528\uff09",id:"\u5173\u95ed\u9632\u706b\u5899\u4e91\u8fb9\u5171\u7528",level:2},{value:"\u5f00\u542f ipv 4 \u8f6c\u53d1\u914d\u7f6e iptables \u53c2\u6570\uff08\u4e91\u8fb9\u5171\u7528\uff09",id:"\u5f00\u542f-ipv-4-\u8f6c\u53d1\u914d\u7f6e-iptables-\u53c2\u6570\u4e91\u8fb9\u5171\u7528",level:2},{value:"\u7981\u7528 swap \u5206\u533a\uff08\u4e91\u8fb9\u5171\u7528\uff09",id:"\u7981\u7528-swap-\u5206\u533a\u4e91\u8fb9\u5171\u7528",level:2},{value:"\u8bbe\u7f6e\u4e3b\u673a\u540d\uff08\u4e91\u8fb9\u5171\u7528\uff09",id:"\u8bbe\u7f6e\u4e3b\u673a\u540d\u4e91\u8fb9\u5171\u7528",level:2},{value:"\u8bbe\u7f6e DNS\uff08\u4e91\u8fb9\u5171\u7528\uff09",id:"\u8bbe\u7f6e-dns\u4e91\u8fb9\u5171\u7528",level:2},{value:"\u5b89\u88c5\u5e76\u914d\u7f6e docker\uff08\u4e91\u8fb9\u5171\u7528\uff09",id:"\u5b89\u88c5\u5e76\u914d\u7f6e-docker\u4e91\u8fb9\u5171\u7528",level:2},{value:"\u8bbe\u7f6e\u8de8\u8282\u70b9\u65f6\u949f\u540c\u6b65\uff08\u4e91\u8fb9\u5171\u7528\uff09",id:"\u8bbe\u7f6e\u8de8\u8282\u70b9\u65f6\u949f\u540c\u6b65\u4e91\u8fb9\u5171\u7528",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"\u524d\u7f6e\u8981\u6c42",children:"\u524d\u7f6e\u8981\u6c42"})}),"\n",(0,t.jsx)(n.p,{children:"\u8bf7\u5728\u5b89\u88c5\u524d\u5b8c\u6210\u524d\u7f6e\u8981\u6c42\u7684\u51c6\u5907\u5de5\u4f5c\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"\u5173\u95ed\u9632\u706b\u5899\u4e91\u8fb9\u5171\u7528",children:"\u5173\u95ed\u9632\u706b\u5899\uff08\u4e91\u8fb9\u5171\u7528\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ufw disable\t\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u5f00\u542f-ipv-4-\u8f6c\u53d1\u914d\u7f6e-iptables-\u53c2\u6570\u4e91\u8fb9\u5171\u7528",children:"\u5f00\u542f ipv 4 \u8f6c\u53d1\u914d\u7f6e iptables \u53c2\u6570\uff08\u4e91\u8fb9\u5171\u7528\uff09"}),"\n",(0,t.jsxs)(n.p,{children:["\u5c06\u6865\u63a5\u7684 ",(0,t.jsx)(n.code,{children:"IPv4/IPv6"})," \u6d41\u91cf\u4f20\u9012\u5230 iptables \u7684\u94fe"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"modprobe br_netfilter\n\ncat >> /etc/sysctl.conf << EOF\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nnet.ipv4.ip_forward = 1\nEOF\n\nsysctl -p \n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u7981\u7528-swap-\u5206\u533a\u4e91\u8fb9\u5171\u7528",children:"\u7981\u7528 swap \u5206\u533a\uff08\u4e91\u8fb9\u5171\u7528\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u4e34\u65f6\u5173\u95ed\nswapoff -a\n# \u6c38\u4e45\u5173\u95ed                                          \nsed -ri 's/.*swap.*/#&/' /etc/fstab                 \n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u8bbe\u7f6e\u4e3b\u673a\u540d\u4e91\u8fb9\u5171\u7528",children:"\u8bbe\u7f6e\u4e3b\u673a\u540d\uff08\u4e91\u8fb9\u5171\u7528\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u4e3a\u5206\u5e03\u5f0f\u96c6\u7fa4\u7684\u6bcf\u4e2a\u8282\u70b9\u8bbe\u7f6e\u4e3b\u673a\u540d\n# \u5982:\n# \u4e91\u670d\u52a1\u5668\nhostnamectl set-hostname master   \n# \u8fb9\nhostnamectl set-hostname edge1\nhostnamectl set-hostname edge2\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u8bbe\u7f6e-dns\u4e91\u8fb9\u5171\u7528",children:"\u8bbe\u7f6e DNS\uff08\u4e91\u8fb9\u5171\u7528\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u4e0d\u540c\u4e3b\u673a\u4e0a\u4f7f\u7528ifconfig\u67e5\u770bip\u5730\u5740\nsudo vim /etc/hosts\n\n# \u6839\u636e\u81ea\u5df1\u7684ip\u6dfb\u52a0\n# ip \u4e3b\u673a\u540d\n192.168.247.128 master\n192.168.247.129 edge1\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u5b89\u88c5\u5e76\u914d\u7f6e-docker\u4e91\u8fb9\u5171\u7528",children:"\u5b89\u88c5\u5e76\u914d\u7f6e docker\uff08\u4e91\u8fb9\u5171\u7528\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# X86/AMD64\u67b6\u6784\nsudo apt-get update\nsudo apt-get install docker.io -y\n\nsudo systemctl start docker\nsudo systemctl enable docker\n\nsudo docker --version\n\n# ARM64 \u67b6\u6784\nsudo apt-get update\nsudo apt-get install curl wget apt-transport-https ca-certificates software-properties-common\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\nsudo add-apt-repository "deb [arch=arm64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"\nsudo apt-get update\nsudo apt-get install docker-ce\n\nsudo docker --version\n\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u914d\u7f6edocker daemon"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'sudo vim /etc/docker/daemon.json\n\n# \u4e91\u670d\u52a1\u5668master\u8282\u70b9\u6dfb\u52a0\uff1a\n{\n  "registry-mirrors": ["https://b9pmyelo.mirror.aliyuncs.com"],\n  "exec-opts": ["native.cgroupdriver=systemd"]\n}\n\n# \u8fb9\u7f18\u8282\u70b9\u6dfb\u52a0\uff1a\n{\n  "registry-mirrors": ["https://b9pmyelo.mirror.aliyuncs.com"],\n  "exec-opts": ["native.cgroupdriver=cgroupfs"]\n}\n\n# \u4e91/\u8fb9\u90fd\u8981\u6267\u884c\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n\n# \u67e5\u770b\u4fee\u6539\u540e\u7684docker Cgroup\u7684\u53c2\u6570\ndocker info | grep Cgroup\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u4e3a\u975eroot\u7528\u6237\u914d\u7f6e\u4e0d\u9700\u8981sudo\u64cd\u4f5cdocker"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo groupadd docker  # \u521b\u5efa\u7ec4\uff0c\u5982\u679c\u5df2\u5b58\u5728\u4f1a\u62a5\u9519\uff0c\u53ef\u5ffd\u7565\nsudo gpasswd -a ${USER} docker\nsudo systemctl restart docker\nsudo chmod a+rw /var/run/docker.sock\n\n# \u9a8c\u8bc1\ndocker images\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u65e0\u6cd5\u8bbf\u95ee",(0,t.jsx)(n.a,{href:"https://hub.docker.com/",children:"Dockerhub"}),"\uff0c\u9700\u8bbe\u7f6edocker\u955c\u50cf\u6e90\uff0c\u53ef\u53c2\u8003",(0,t.jsx)(n.a,{href:"/docs/developer-guide/how-to-build/docker-registry",children:"docker\u955c\u50cf\u6e90\u914d\u7f6e"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"\u8bbe\u7f6e\u8de8\u8282\u70b9\u65f6\u949f\u540c\u6b65\u4e91\u8fb9\u5171\u7528",children:"\u8bbe\u7f6e\u8de8\u8282\u70b9\u65f6\u949f\u540c\u6b65\uff08\u4e91\u8fb9\u5171\u7528\uff09"}),"\n",(0,t.jsx)(n.p,{children:"\u5206\u5e03\u5f0f\u7cfb\u7edf\u9700\u8981\u4fdd\u8bc1\u6bcf\u4e2a\u8282\u70b9\u7684\u65f6\u949f\u662f\u540c\u6b65\u7684\uff0c\u91c7\u7528NTP\u670d\u52a1\u540c\u6b65\u4e91\u8fb9\u5206\u5e03\u5f0f\u8282\u70b9"}),"\n",(0,t.jsx)(n.p,{children:"\u5b89\u88c5NTP\u670d\u52a1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install ntp\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u914d\u7f6eNTP\u670d\u52a1\uff0c\u4fee\u6539/etc/ntp.conf\u6587\u4ef6"}),"\n",(0,t.jsx)(n.p,{children:"\u4e91\u7aef\u4ece\u516c\u5171NTP\u670d\u52a1\u5668\u540c\u6b65\u65f6\u95f4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"# Specify one or more NTP servers.\n\nserver 1.networktime.org iburst\nserver 2.networktime.org iburst\nserver ntp.synet.edu.cn iburst\nserver ntp.neu6.edu.cn iburst\nserver ntp.gwadar.cn iburst\nserver ntp.neu.edu.cn iburst\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u8fb9\u7aef\u4ece\u4e91\u7aef\u540c\u6b65\u65f6\u95f4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"# Specify one or more NTP servers.\nserver 114.212.81.11  iburst\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u542f\u52a8NTP\u670d\u52a1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl start ntp\nsudo systemctl enable ntp\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u9a8c\u8bc1\u65f6\u95f4\u540c\u6b65\u72b6\u6001"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ntpq -p\n"})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>a});var r=s(6540);const t={},l=r.createContext(t);function d(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);