"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4908],{413:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"getting-started/install-lower-layer-system/install-kubeedge","title":"Install KubeEdge","description":"Download keadm (both cloud/edge)","source":"@site/docs/03-getting-started/02-install-lower-layer-system/03-install-kubeedge.md","sourceDirName":"03-getting-started/02-install-lower-layer-system","slug":"/getting-started/install-lower-layer-system/install-kubeedge","permalink":"/docs/getting-started/install-lower-layer-system/install-kubeedge","draft":false,"unlisted":false,"editUrl":null,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_label":"Install KubeEdge","slug":"/getting-started/install-lower-layer-system/install-kubeedge","custom_edit_url":null},"sidebar":"tutorialSidebar","previous":{"title":"Install Kubernetes","permalink":"/docs/getting-started/install-lower-layer-system/install-kubernetes"},"next":{"title":"Install EdgeMesh","permalink":"/docs/getting-started/install-lower-layer-system/install-edgemesh"}}');var r=t(4848),l=t(8453);const a={sidebar_label:"Install KubeEdge",slug:"/getting-started/install-lower-layer-system/install-kubeedge",custom_edit_url:null},d="Install KubeEdge",o={},i=[{value:"Download keadm (both cloud/edge)",id:"download-keadm-both-cloudedge",level:2},{value:"Start KubeEdge (cloud)",id:"start-kubeedge-cloud",level:2},{value:"Reset environment (Skip on first installation)",id:"reset-environment-skip-on-first-installation",level:3},{value:"Start cloudcore",id:"start-cloudcore",level:3},{value:"Configure cloudcore",id:"configure-cloudcore",level:3},{value:"Join KubeEdge cluster (edge)",id:"join-kubeedge-cluster-edge",level:2},{value:"Reset environment (Skip on first installation)",id:"reset-environment-skip-on-first-installation-1",level:3},{value:"Start edgecore",id:"start-edgecore",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"install-kubeedge",children:"Install KubeEdge"})}),"\n",(0,r.jsx)(n.h2,{id:"download-keadm-both-cloudedge",children:"Download keadm (both cloud/edge)"}),"\n",(0,r.jsx)(n.p,{children:"keadm is mainly used for kubeedge management, installation, and usage."}),"\n",(0,r.jsxs)(n.p,{children:["Official release version link: ",(0,r.jsx)(n.a,{href:"https://github.com/kubeedge/kubeedge/releases/",children:"Release KubeEdge v1.9.2 release \xb7 kubeedge/kubeedge (github.com)"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check machine architecture\nuname -a\n# Download keadm with corresponding version and architecture\nwget https://github.com/kubeedge/kubeedge/releases/download/v1.9.2/keadm-v1.9.2-linux-amd64.tar.gz\n# Unzip\ntar zxvf keadm-v1.9.2-linux-amd64.tar.gz\n# Add execution permissions\nchmod +x keadm-v1.9.2-linux-amd64/keadm/keadm \n# Move to /usr/local/bin/\ncp keadm-v1.9.2-linux-amd64/keadm/keadm /usr/local/bin/\n"})}),"\n",(0,r.jsx)(n.h2,{id:"start-kubeedge-cloud",children:"Start KubeEdge (cloud)"}),"\n",(0,r.jsxs)(n.p,{children:["This step may occur ",(0,r.jsx)(n.a,{href:"/docs/getting-started/install-lower-layer-system/faqs#question-4-10002-already-in-use",children:"Question 4\uff1a10002 already in use"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"reset-environment-skip-on-first-installation",children:"Reset environment (Skip on first installation)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"keadm reset\n"})}),"\n",(0,r.jsx)(n.h3,{id:"start-cloudcore",children:"Start cloudcore"}),"\n",(0,r.jsx)(n.p,{children:"Start cloudcore by keadm."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Modify the ip address of '--adverse-address'\nkeadm init --advertise-address=114.212.81.11 --kubeedge-version=1.9.2\n\n# Open forwarding route\nkubectl get cm tunnelport -n kubeedge -o yaml\n# find '10350' or '10351' in the result\n\n# set CLOUDCOREIPS\nexport CLOUDCOREIPS=xxx.xxx.xxx.xxx\n# set 'dport' as previously 'tunnelport'\niptables -t nat -A OUTPUT -p tcp --dport 10351 -j DNAT --to $CLOUDCOREIPS:10003\n\ncd /etc/kubeedge/\n\n# or download manually from https://github.com/kubeedge/kubeedge/blob/master/build/tools/certgen.sh\nwget https://raw.githubusercontent.com/kubeedge/kubeedge/refs/heads/master/build/tools/certgen.sh\n\nbash certgen.sh stream\n"})}),"\n",(0,r.jsx)(n.h3,{id:"configure-cloudcore",children:"Configure cloudcore"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"vim /etc/kubeedge/config/cloudcore.yaml\n\n# modify cloudcore.yaml \nmodules:\n  ..\n  cloudStream:\n    enable: true\n    streamPort: 10003\n  ..\n  dynamicController:\n    enable: true\n"})}),"\n",(0,r.jsx)(n.p,{children:"Restart cloudcore\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo systemctl restart cloudcore.service\n"})}),"\n",(0,r.jsx)(n.p,{children:"If restarting cloudcore fails, the solution is as follows:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Place the generated 'cloudcore.service' under the folder managed by systemctl\ncp /etc/kubeedge/cloudcore.service /etc/systemd/system\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"journalctl -u cloudcore.service -xe"})," to check if cloudcore is running normally and there are no errors reported."]}),"\n",(0,r.jsx)(n.h2,{id:"join-kubeedge-cluster-edge",children:"Join KubeEdge cluster (edge)"}),"\n",(0,r.jsxs)(n.p,{children:["This step may occur ",(0,r.jsx)(n.a,{href:"/docs/getting-started/install-lower-layer-system/faqs#question-5-edgecore-file-exists",children:"Question 5\uff1aedgecore file exists"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["If ",(0,r.jsx)(n.code,{children:"keadm join"})," fails, you can retry from ",(0,r.jsx)(n.code,{children:"keadm reset"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"reset-environment-skip-on-first-installation-1",children:"Reset environment (Skip on first installation)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# reset\nkeadm reset\n\n# When rejoining, if an error was reported that there was a folder, just deleted directly.\nrm -rf /etc/kubeedge\n\n# Possible docker container occupancy (usually 'mqtt')\ndocker ps -a\ndocker stop mqtt\ndocker rm mqtt\n"})}),"\n",(0,r.jsx)(n.h3,{id:"start-edgecore",children:"Start edgecore"}),"\n",(0,r.jsx)(n.p,{children:"To start edgecore, you need to get token on the master node (cloud) first:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"keadm gettoken\n"})}),"\n",(0,r.jsx)(n.p,{children:"Execute on the edge:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Add IP address of the master here. The token here is obtained from the master\nkeadm join --cloudcore-ipport=114.212.81.11:10000 --kubeedge-version=1.9.2 --token=9e1832528ae701aba2c4f7dfb49183ab2487e874c8090e68c19c95880cd93b50.eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTk1NjU4MzF9.1B4su4QwvQy_ZCPs-PIyDT9ixsDozfN1oG4vX59tKDs\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This step may occur ",(0,r.jsx)(n.a,{href:"/docs/getting-started/install-lower-layer-system/faqs#question-25-keadm-join-error-on-edge-nodes",children:"Question 25\uff1akeadm join error on edge nodes"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check for logs\njournalctl -u edgecore.service -f\n"})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>d});var s=t(6540);const r={},l=s.createContext(r);function a(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);